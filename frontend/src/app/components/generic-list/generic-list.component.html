<h3>{{ editingItem ? 'Modifier' : 'Ajouter' }}</h3>

<div *ngFor="let field of fields">

  <!-- TEXT -->
  <input *ngIf="field.type === 'text'"
         [(ngModel)]="currentModel[field.name]"
         [placeholder]="field.name" />

  <!-- SELECT (ENUM) -->
  <select *ngIf="field.type === 'select'"
          [(ngModel)]="currentModel[field.name]">
    <option *ngFor="let opt of field.options"
            [value]="opt">
      {{ opt }}
    </option>
  </select>

  <!-- ARRAY SIMPLE -->
  <div *ngIf="field.type === 'array'">
    <div *ngFor="let item of currentModel[field.name]; let i = index">
      <input [(ngModel)]="currentModel[field.name][i]" />
      <button type="button"
              (click)="removeArrayItem(field.name, i)">
        X
      </button>
    </div>
    <button type="button"
            (click)="addArrayItem(field.name)">
      Ajouter
    </button>
  </div>

  <!-- RELATION -->
  <select *ngIf="field.type === 'relation'"
          [(ngModel)]="currentModel[field.name]">
    <option *ngFor="let r of relationsData[field.name]"
            [value]="r._id">
      {{ r.name || r.title || r.label }}
    </option>
  </select>

</div>

<button type="button"
        (click)="editingItem ? save() : submit()">
  {{ editingItem ? 'Enregistrer' : 'Ajouter' }}
</button>

<hr>

<table border="1">
  <tr>
    <th *ngFor="let field of fields">{{ field.name }}</th>
    <th>Actions</th>
  </tr>

  <tr *ngFor="let item of items">
    <td *ngFor="let field of fields">

      <!-- Relation affichÃ©e -->
      <span *ngIf="item[field.name]?._id">
        {{ item[field.name].name || item[field.name].title }}
      </span>

      <!-- Array affichage -->
      <span *ngIf="isArray(item[field.name])">
        {{ item[field.name].join(', ') }}
      </span>

      <!-- Simple -->
<span *ngIf="!item[field.name]?._id && !isArray(item[field.name])">
  {{ item[field.name] }}
</span>

    </td>

    <td>
      <button (click)="edit(item)">Modifier</button>
      <button (click)="delete(item._id)">Supprimer</button>
    </td>
  </tr>
</table>


